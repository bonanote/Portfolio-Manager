<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simple Stock Tracker (No API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.13/dayjs.min.js"></script>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 20px; background: #f4f6f8; color: #333; }
  h1 { text-align: center; color: #1a1a1a; margin-bottom: 5px; }
  .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 0.9em; }

  /* Main Container */
  .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }

  /* Controls */
  .controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  button.add-btn { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 16px; cursor: pointer; display: flex; align-items: center; gap: 8px; transition: background 0.2s; }
  button.add-btn:hover { background: #0056b3; }
  button.clear-btn { background: transparent; color: #dc3545; border: 1px solid #dc3545; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 14px; }
  button.clear-btn:hover { background: #fff5f5; }

  /* Table */
  .table-wrapper { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; min-width: 800px; }
  th { text-align: left; padding: 12px; color: #666; font-size: 13px; text-transform: uppercase; border-bottom: 2px solid #eee; }
  td { padding: 12px; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
  tr:last-child td { border-bottom: none; }

  /* Inputs */
  input { padding: 8px 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; width: 100%; box-sizing: border-box; transition: border 0.2s; }
  input:focus { border-color: #007bff; outline: none; }
  input.ticker-input { text-transform: uppercase; font-weight: bold; width: 80px; }
  input.num-input { width: 100px; }
  
  /* Current Price Input Styling */
  .current-price-wrapper { position: relative; }
  .current-price-wrapper input { border-color: #007bff; background-color: #f0f7ff; font-weight: bold; color: #0056b3; }
  .current-price-wrapper::after { content: "Update Me"; position: absolute; right: -70px; top: 50%; transform: translateY(-50%); font-size: 10px; color: #007bff; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
  .current-price-wrapper:hover::after { opacity: 1; }

  /* Yahoo Link */
  .yahoo-link { text-decoration: none; color: #666; font-size: 14px; margin-left: 8px; padding: 4px; border-radius: 4px; background: #eee; transition: all 0.2s; }
  .yahoo-link:hover { background: #500095; color: white; }

  /* Badges */
  .gain-tag { padding: 4px 8px; border-radius: 4px; font-weight: 600; font-size: 14px; display: inline-block; min-width: 60px; text-align: center; }
  .positive { background: #d4edda; color: #155724; }
  .negative { background: #f8d7da; color: #721c24; }
  .neutral { background: #eee; color: #666; }

  /* Remove Button */
  .remove-btn { color: #ccc; background: none; border: none; font-size: 18px; cursor: pointer; padding: 0 10px; }
  .remove-btn:hover { color: #dc3545; }

  /* Summary Footer */
  .summary { margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee; display: flex; justify-content: flex-end; gap: 40px; }
  .summary-item { text-align: right; }
  .summary-label { display: block; color: #666; font-size: 12px; margin-bottom: 4px; }
  .summary-value { font-size: 24px; font-weight: 700; color: #333; }
</style>
</head>
<body>

<h1>My Stock Portfolio</h1>
<div class="subtitle">Manual Tracker ‚Ä¢ No API Keys ‚Ä¢ Auto-Saves</div>

<div class="container">
  <div class="controls">
    <button class="add-btn" onclick="addStock()">+ Add Stock</button>
    <button class="clear-btn" onclick="clearData()">Reset All</button>
  </div>

  <div class="table-wrapper">
    <table id="portfolioTable">
      <thead>
        <tr>
          <th width="15%">Ticker</th>
          <th width="15%">Shares</th>
          <th width="15%">Avg. Cost ($)</th>
          <th width="20%">Current Price ($)</th>
          <th width="15%">Market Value</th>
          <th width="15%">Gain/Loss</th>
          <th width="5%"></th>
        </tr>
      </thead>
      <tbody>
        <!-- Rows will be injected here -->
      </tbody>
    </table>
  </div>

  <div class="summary">
    <div class="summary-item">
      <span class="summary-label">TOTAL COST</span>
      <span class="summary-value" id="totalCost">$0.00</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">CURRENT VALUE</span>
      <span class="summary-value" id="totalValue">$0.00</span>
    </div>
    <div class="summary-item">
      <span class="summary-label">TOTAL GAIN</span>
      <span class="summary-value" id="totalGain">$0.00</span>
    </div>
  </div>
</div>

<script>
// Load data from LocalStorage on startup
let portfolio = JSON.parse(localStorage.getItem('myPortfolio')) || [
  { id: Date.now(), ticker: 'AAPL', shares: 10, cost: 150, current: 220 }
];

const tbody = document.querySelector("#portfolioTable tbody");

function saveData() {
  localStorage.setItem('myPortfolio', JSON.stringify(portfolio));
  render();
}

function addStock() {
  portfolio.push({
    id: Date.now(),
    ticker: '',
    shares: 0,
    cost: 0,
    current: 0
  });
  render();
}

function removeStock(id) {
  portfolio = portfolio.filter(stock => stock.id !== id);
  saveData();
}

function updateStock(id, field, value) {
  const stock = portfolio.find(s => s.id === id);
  if (stock) {
    if (field === 'ticker') {
      stock[field] = value.toUpperCase();
    } else {
      stock[field] = parseFloat(value) || 0;
    }
    saveData();
  }
}

function clearData() {
  if(confirm("Delete all data?")) {
    portfolio = [];
    saveData();
  }
}

function render() {
  tbody.innerHTML = '';
  let totalCost = 0;
  let totalValue = 0;

  portfolio.forEach(stock => {
    const marketValue = stock.shares * stock.current;
    const costBasis = stock.shares * stock.cost;
    const gain = marketValue - costBasis;
    const gainPct = costBasis > 0 ? (gain / costBasis) * 100 : 0;

    totalCost += costBasis;
    totalValue += marketValue;

    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>
        <div style="display:flex; align-items:center;">
          <input type="text" class="ticker-input" value="${stock.ticker}" 
            oninput="updateStock(${stock.id}, 'ticker', this.value)" placeholder="SYM">
          ${stock.ticker ? `<a href="https://finance.yahoo.com/quote/${stock.ticker}" target="_blank" class="yahoo-link" title="Check Price on Yahoo">üîç</a>` : ''}
        </div>
      </td>
      <td>
        <input type="number" class="num-input" value="${stock.shares || ''}" 
          oninput="updateStock(${stock.id}, 'shares', this.value)" placeholder="0">
      </td>
      <td>
        <input type="number" class="num-input" value="${stock.cost || ''}" 
          oninput="updateStock(${stock.id}, 'cost', this.value)" placeholder="0.00">
      </td>
      <td>
        <div class="current-price-wrapper">
          <input type="number" class="num-input" value="${stock.current || ''}" 
            oninput="updateStock(${stock.id}, 'current', this.value)" placeholder="0.00">
        </div>
      </td>
      <td style="font-weight:bold;">$${marketValue.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}</td>
      <td>
        <span class="gain-tag ${gain >= 0 ? 'positive' : 'negative'}">
          ${gain >= 0 ? '+' : ''}${gain.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0})} 
          (${gainPct.toFixed(1)}%)
        </span>
      </td>
      <td>
        <button class="remove-btn" onclick="removeStock(${stock.id})">&times;</button>
      </td>
    `;
    tbody.appendChild(tr);
  });

  // Update Summary
  document.getElementById('totalCost').textContent = '$' + totalCost.toLocaleString(undefined, {minimumFractionDigits: 2});
  document.getElementById('totalValue').textContent = '$' + totalValue.toLocaleString(undefined, {minimumFractionDigits: 2});
  
  const totalGain = totalValue - totalCost;
  const totalGainEl = document.getElementById('totalGain');
  totalGainEl.textContent = (totalGain >= 0 ? '+' : '') + '$' + totalGain.toLocaleString(undefined, {minimumFractionDigits: 2});
  totalGainEl.style.color = totalGain >= 0 ? '#155724' : '#721c24';
}

// Initial Render
render();

</script>
</body>
</html>
